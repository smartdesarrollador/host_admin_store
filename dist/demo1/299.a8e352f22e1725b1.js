"use strict";(self.webpackChunkdemo1=self.webpackChunkdemo1||[]).push([[299],{7299:($,u,r)=>{r.r(u),r.d(u,{PermissionModule:()=>U});var d=r(6814),l=r(6223),f=r(7304),c=r(1274),g=r(5722),h=r(4955),v=r(9155),t=r(5879),_=r(6676),C=r.n(_),b=r(9862);let x=(()=>{class s{http;apiUrl="https://preview.keenthemes.com/starterkit/metronic/laravel/api/v1/permissions";constructor(e){this.http=e}getPermissions(e){return this.http.post(`${this.apiUrl}-list`,e)}getPermission(e){return this.http.get(`${this.apiUrl}/${e}`)}createPermission(e){return this.http.post(this.apiUrl,e)}updatePermission(e,i){return this.http.put(`${this.apiUrl}/${e}`,i)}deletePermission(e){return this.http.delete(`${this.apiUrl}/${e}`)}static \u0275fac=function(i){return new(i||s)(t.LFG(b.eN))};static \u0275prov=t.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"})}return s})();var T=r(431),Z=r(8704);const y=["noticeSwal"];function A(s,m){1&s&&(t.TgZ(0,"div"),t._uU(1,"Permission name is required"),t.qZA())}function P(s,m){1&s&&(t.TgZ(0,"div"),t._uU(1,"Permission name must be at least 4 characters long"),t.qZA())}function M(s,m){if(1&s&&(t.TgZ(0,"div",37),t.YNc(1,A,2,0,"div",38),t.YNc(2,P,2,0,"div",38),t.qZA()),2&s){t.oxw();const e=t.MAs(18);t.xp6(1),t.Q6J("ngIf",null==e.errors?null:e.errors.required),t.xp6(1),t.Q6J("ngIf",null==e.errors?null:e.errors.minlength)}}const w=function(s){return{"ki-up":s}};function S(s,m){if(1&s){const e=t.EpF();t.TgZ(0,"form",14,15),t.NdJ("ngSubmit",function(n){t.CHM(e);const o=t.MAs(1),a=t.oxw();return t.KtG(a.onSubmit(n,o))}),t.TgZ(2,"div",16)(3,"h4",17),t._uU(4,"Permission Details"),t.qZA(),t.TgZ(5,"button",18),t.NdJ("click",function(){const o=t.CHM(e).$implicit;return t.KtG(o.dismiss("Cross click"))}),t.qZA()(),t.TgZ(6,"div",19)(7,"div",20)(8,"div",21),t.NdJ("click",function(){t.CHM(e);const n=t.MAs(13);return t.KtG(n.toggle())}),t._uU(9,"User Information "),t.TgZ(10,"span",22),t._UZ(11,"i",23),t.qZA()(),t.TgZ(12,"div",24,25),t.NdJ("ngbCollapseChange",function(n){t.CHM(e);const o=t.oxw();return t.KtG(o.isCollapsed1=n)}),t.TgZ(14,"div",26)(15,"label",27),t._uU(16,"Name"),t.qZA(),t.TgZ(17,"input",28,29),t.NdJ("ngModelChange",function(n){t.CHM(e);const o=t.oxw();return t.KtG(o.permissionModel.name=n)}),t.qZA(),t.YNc(19,M,3,2,"div",30),t.qZA()()()(),t.TgZ(20,"div",31)(21,"button",32),t.NdJ("click",function(){const o=t.CHM(e).$implicit;return t.KtG(o.dismiss("cancel"))}),t._uU(22," Discard "),t.qZA(),t.TgZ(23,"button",33)(24,"span",34),t._uU(25," Submit "),t.qZA(),t.TgZ(26,"span",35),t._uU(27," Please wait... "),t._UZ(28,"span",36),t.qZA()()()()}if(2&s){const e=t.MAs(1),i=t.oxw();t.xp6(8),t.uIk("aria-expanded",!i.isCollapsed1),t.xp6(3),t.Q6J("ngClass",t.VKq(6,w,!i.isCollapsed1)),t.xp6(1),t.Q6J("ngbCollapse",i.isCollapsed1),t.xp6(5),t.Q6J("ngModel",i.permissionModel.name),t.xp6(2),t.Q6J("ngIf",e.submitted&&e.invalid),t.xp6(4),t.uIk("data-kt-indicator",i.isLoading?"on":"off")}}let k=(()=>{class s{apiService;cdr;isCollapsed1=!1;isLoading=!1;permissions;datatableConfig={};reloadEvent=new t.vpe;permission$;permissionModel={id:0,name:""};noticeSwal;swalOptions={};constructor(e,i){this.apiService=e,this.cdr=i}ngAfterViewInit(){}ngOnInit(){this.datatableConfig={serverSide:!0,ajax:(e,i)=>{this.apiService.getPermissions(e).subscribe(n=>{console.log(n),i(n)})},columns:[{title:"Name",data:"name",render:(e,i,n)=>`<a href="javascript:;" data-action="view" data-id="${n.id}" class="text-gray-800 text-hover-primary mb-1">${e}</a>`},{title:"Assigned To",data:null,render:function(e,i,n){return Array.isArray(e.roles)?e.roles.map(function(o){return`<a href="#" class="badge fs-7 m-1 badge-light-${["info","success","warning","danger","primary"][Math.floor(5*Math.random())]}">${o.name}</a>`}).join(""):""},orderData:[1],orderSequence:["asc","desc"],type:"string"},{title:"Created Date",data:"created_at",render:function(e){return C()(e).format("DD MMM YYYY, hh:mm a")}}]}}delete(e){this.apiService.deletePermission(e).subscribe(()=>{this.reloadEvent.emit(!0)})}edit(e){this.permission$=this.apiService.getPermission(e),this.permission$.subscribe(i=>{this.permissionModel=i})}create(){this.permissionModel={id:0,name:""}}onSubmit(e,i){if(i&&i.invalid)return;this.isLoading=!0;const n={icon:"success",title:"Success!",text:this.permissionModel.id>0?"Permission updated successfully!":"Permission created successfully!"},o={icon:"error",title:"Error!",text:""},a=()=>{this.isLoading=!1};this.permissionModel.id>0?(()=>{this.apiService.updatePermission(this.permissionModel.id,this.permissionModel).subscribe({next:()=>{this.showAlert(n),this.reloadEvent.emit(!0)},error:p=>{o.text=this.extractText(p.error),this.showAlert(o),this.isLoading=!1},complete:a})})():(()=>{this.apiService.createPermission(this.permissionModel).subscribe({next:()=>{this.showAlert(n),this.reloadEvent.emit(!0)},error:p=>{o.text=this.extractText(p.error),this.showAlert(o),this.isLoading=!1},complete:a})})()}extractText(e){var i=[];for(var n in e)"string"==typeof e[n]?i.push(e[n]):"object"==typeof e[n]&&(i=i.concat(this.extractText(e[n])));return Array.from(new Set(i)).join("\n")}showAlert(e){let i=e.icon?.toString()||"success";"error"===e.icon&&(i="danger"),this.swalOptions=Object.assign({buttonsStyling:!1,confirmButtonText:"Ok, got it!",customClass:{confirmButton:"btn btn-"+i}},e),this.cdr.detectChanges(),this.noticeSwal.fire()}ngOnDestroy(){}static \u0275fac=function(i){return new(i||s)(t.Y36(x),t.Y36(t.sBO))};static \u0275cmp=t.Xpm({type:s,selectors:[["app-permission-listing"]],viewQuery:function(i,n){if(1&i&&t.Gf(y,5),2&i){let o;t.iGM(o=t.CRH())&&(n.noticeSwal=o.first)}},decls:16,vars:4,consts:[[1,"card"],[1,"card-header","border-0","pt-6"],[1,"card-title"],[1,"d-flex","align-items-center","position-relative","my-1"],["name","magnifier",1,"fs-3","position-absolute","ms-5"],["type","text","data-action","filter","placeholder","Search Users",1,"form-control","form-control-solid","w-250px","ps-12"],[1,"card-toolbar"],[1,"d-flex","justify-content-end"],["type","button","data-action","create",1,"btn","btn-primary"],[1,"card-body","pt-0"],["route","/apps/users",3,"datatableConfig","reload","modal","deleteEvent","editEvent","createEvent"],[3,"swalOptions"],["noticeSwal",""],["formModal",""],[3,"ngSubmit"],["myForm","ngForm"],[1,"modal-header"],["id","modal-basic-title",1,"modal-title"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],["id","kt_modal_update_customer_scroll","data-kt-scroll","true","data-kt-scroll-activate","{default: false, lg: true}","data-kt-scroll-max-height","auto","data-kt-scroll-dependencies","#kt_modal_update_customer_header","data-kt-scroll-wrappers","#kt_modal_update_customer_scroll","data-kt-scroll-offset","300px",1,"d-flex","flex-column","scroll-y","me-n7","pe-7","mw-650px"],["data-bs-toggle","collapse","role","button","aria-controls","kt_modal_update_customer_user_info",1,"fw-bold","fs-3","rotate","collapsible","mb-7",3,"click"],[1,"ms-2","rotate-180"],[1,"ki-duotone","ki-down","fs-3",3,"ngClass"],[1,"collapse","show",3,"ngbCollapse","ngbCollapseChange"],["collapse1","ngbCollapse"],[1,"fv-row","mb-7"],[1,"required","fw-semibold","fs-6","mb-2"],["type","text","name","name","required","","minlength","4",1,"form-control","form-control-solid",3,"ngModel","ngModelChange"],["name","ngModel"],["class","fv-plugins-message-container fv-plugins-message-container--enabled invalid-feedback",4,"ngIf"],[1,"modal-footer","flex-center"],["type","reset","id","kt_modal_update_customer_cancel",1,"btn","btn-light","me-3",3,"click"],["type","submit","id","kt_modal_update_customer_submit",1,"btn","btn-primary"],[1,"indicator-label"],[1,"indicator-progress"],[1,"spinner-border","spinner-border-sm","align-middle","ms-2"],[1,"fv-plugins-message-container","fv-plugins-message-container--enabled","invalid-feedback"],[4,"ngIf"]],template:function(i,n){if(1&i&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),t._UZ(4,"app-keenicon",4)(5,"input",5),t.qZA()(),t.TgZ(6,"div",6)(7,"div",7)(8,"button",8),t._uU(9," Add Permissions "),t.qZA()()()(),t.TgZ(10,"div",9)(11,"app-crud",10),t.NdJ("deleteEvent",function(a){return n.delete(a)})("editEvent",function(a){return n.edit(a)})("createEvent",function(){return n.create()}),t.qZA()()(),t._UZ(12,"swal",11,12),t.YNc(14,S,29,8,"ng-template",null,13,t.W1O)),2&i){const o=t.MAs(15);t.xp6(11),t.Q6J("datatableConfig",n.datatableConfig)("reload",n.reloadEvent)("modal",o),t.xp6(1),t.Q6J("swalOptions",n.swalOptions)}},dependencies:[d.mk,d.O5,l._Y,l.Fj,l.JJ,l.JL,l.Q7,l.wO,l.On,l.F,T.D,Z.q,c._D,g.q1]})}return s})(),L=(()=>{class s{static \u0275fac=function(i){return new(i||s)};static \u0275cmp=t.Xpm({type:s,selectors:[["app-permission-details"]],decls:2,vars:0,template:function(i,n){1&i&&(t.TgZ(0,"p"),t._uU(1,"permission-details works!"),t.qZA())}})}return s})(),U=(()=>{class s{static \u0275fac=function(i){return new(i||s)};static \u0275mod=t.oAB({type:s});static \u0275inj=t.cJS({imports:[d.ez,l.u5,l.UX,f.Bz.forChild([{path:"",component:k},{path:":id",component:L}]),v.Z,h.m,c.Oz,c.XC,c.lQ,c.HK,g.ii.forChild()]})}return s})()}}]);